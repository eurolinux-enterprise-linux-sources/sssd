From e1fb42928cd94758f2db09ad5fcdda85e1378741 Mon Sep 17 00:00:00 2001
From: Petr Cech <pcech@redhat.com>
Date: Mon, 11 Jan 2016 06:18:33 -0500
Subject: [PATCH 8/9] KRB5: Adding DNS SRV lookup for krb5 provider

This patch add DNS SRV lookup for krb5 provider.

Resolves:
https://fedorahosted.org/sssd/ticket/2888

Reviewed-by: Jakub Hrozek <jhrozek@redhat.com>
(cherry picked from commit 684191e61d891b1c34f3742a40d5a2ed6a1192dd)
---
 src/providers/krb5/krb5_init.c | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/src/providers/krb5/krb5_init.c b/src/providers/krb5/krb5_init.c
index f1c63107642fba8441ff563bd9ecd7eff233d65c..4f36d905b1d5e89466998fba946f9f6f6915f51d 100644
--- a/src/providers/krb5/krb5_init.c
+++ b/src/providers/krb5/krb5_init.c
@@ -169,6 +169,13 @@ int sssm_krb5_auth_init(struct be_ctx *bectx,
     }
     talloc_set_destructor((TALLOC_CTX *) ctx, krb5_ctx_re_destructor);
 
+    ret = be_fo_set_dns_srv_lookup_plugin(bectx, NULL);
+    if (ret != EOK) {
+        DEBUG(SSSDBG_CRIT_FAILURE, "Unable to set SRV lookup plugin "
+                                   "[%d]: %s\n", ret, sss_strerror(ret));
+        goto fail;
+    }
+
     *ops = &krb5_auth_ops;
     *pvt_auth_data = ctx;
     return EOK;
-- 
2.4.3

